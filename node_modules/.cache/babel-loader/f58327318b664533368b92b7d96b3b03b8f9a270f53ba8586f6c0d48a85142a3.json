{"ast":null,"code":"var _jsxFileName = \"C:\\\\Thuchanh\\\\Painter\\\\frontend\\\\src\\\\pages\\\\History\\\\index.js\",\n  _s = $RefreshSig$();\n/* eslint-disable react-hooks/exhaustive-deps */\nimport React, { useState, useEffect } from 'react';\nimport HeaderHistory from \"../../components/Layout/DefautLayout/HeaderHistory\";\nimport styles from \"./History.module.scss\";\nimport classNames from 'classnames/bind';\nimport { createContext } from 'react';\nimport { useUser } from \"../../hook/UserContext\";\nimport Loader from \"../../components/items/Loader\";\nimport { Link } from 'react-router-dom';\nimport useSharedState from \"../../hook/useShareState\";\nimport { connect } from \"react-redux\";\nimport { userLogout } from \"../../actionCreators/LoginAction\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst cx = classNames.bind(styles);\nexport const SizeContext = /*#__PURE__*/createContext();\nfunction History(props) {\n  _s();\n  const [loading, setLoading] = useState(true);\n  const [width, setWidth] = useState(1080);\n  const [height, setHeight] = useState(540);\n  const pathBackEnd = 'http://localhost:8081';\n  const [currentUser, setCurrentUser] = useState(null);\n  const [updateIsEdit] = useSharedState();\n  const setSize = (newWidth, newHeight) => {\n    setWidth(newWidth);\n    setHeight(newHeight);\n  };\n  const [images, setImages] = useState([]);\n  const handleLogout = () => {\n    props.userLogout();\n  };\n  const email = localStorage.getItem('email');\n  const fetchImages = async () => {\n    try {\n      const response = await fetch(`${pathBackEnd}/getAllImages`);\n      const responseData = await response.json();\n      console.log('API response:', responseData);\n      const data = Array.isArray(responseData.images) ? responseData.images : [];\n\n      // const userImages = data.filter((image) => image.user_id === userInfo.user_id);\n      setImages(null);\n      setLoading(false);\n    } catch (error) {\n      console.error('Error fetching images:', error);\n      setLoading(false);\n    }\n  };\n  const formatImageDate = fullDate => {\n    const dateObject = new Date(fullDate);\n    const formattedDate = dateObject.toLocaleDateString();\n    return formattedDate;\n  };\n  const parseJwt = token => {\n    try {\n      const base64Url = token.split(\".\")[1];\n      const base64 = base64Url.replace(\"-\", \"+\").replace(\"_\", \"/\");\n      const decoded = JSON.parse(atob(base64));\n      return decoded;\n    } catch (e) {\n      console.error(\"Error parsing JWT:\", e);\n      return null;\n    }\n  };\n\n  // Usage\n  if (localStorage.getItem(\"token-user\")) {\n    // setCurrentUser({\n    //     email: localStorage.getItem('email'),\n    //     token: localStorage.getItem('token-user'),\n    // });\n  }\n  useEffect(() => {\n    if (email === null) {\n      alert('Directing you back to home');\n      window.location.href = '/'; // Redirect to the home page\n    } else {\n      // Only fetch images if userInfo is not null\n      fetchImages();\n    }\n  }, []);\n  return /*#__PURE__*/_jsxDEV(SizeContext.Provider, {\n    value: {\n      width,\n      height,\n      setWidth,\n      setHeight,\n      setSize\n    },\n    children: [/*#__PURE__*/_jsxDEV(HeaderHistory, {\n      handleLogout: handleLogout\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 108,\n      columnNumber: 13\n    }, this), ' ', /*#__PURE__*/_jsxDEV(\"div\", {\n      className: cx('wrapper'),\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: cx('container-history'),\n        children: loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n          className: cx('overlay'),\n          children: /*#__PURE__*/_jsxDEV(Loader, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 113,\n            columnNumber: 29\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 112,\n          columnNumber: 25\n        }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: [\" This is a history details of User: \", localStorage.getItem('email'), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 29\n          }, this), ' ', /*#__PURE__*/_jsxDEV(\"div\", {\n            className: cx('list-images')\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 99,\n    columnNumber: 9\n  }, this);\n}\n_s(History, \"bXsC2MgcrVlyfXwLct5qLWT6tw8=\", false, function () {\n  return [useSharedState];\n});\n_c = History;\nconst mapStateToProps = state => {\n  return {\n    tokenUser: state.LoginReducer.tokenUser,\n    dataCart: state.UserReducer.dataCart\n  };\n};\nconst mapDispatchToProps = {\n  userLogout\n};\nexport default connect(mapStateToProps, mapDispatchToProps)(History);\nvar _c;\n$RefreshReg$(_c, \"History\");","map":{"version":3,"names":["React","useState","useEffect","HeaderHistory","styles","classNames","createContext","useUser","Loader","Link","useSharedState","connect","userLogout","jsxDEV","_jsxDEV","Fragment","_Fragment","cx","bind","SizeContext","History","props","_s","loading","setLoading","width","setWidth","height","setHeight","pathBackEnd","currentUser","setCurrentUser","updateIsEdit","setSize","newWidth","newHeight","images","setImages","handleLogout","email","localStorage","getItem","fetchImages","response","fetch","responseData","json","console","log","data","Array","isArray","error","formatImageDate","fullDate","dateObject","Date","formattedDate","toLocaleDateString","parseJwt","token","base64Url","split","base64","replace","decoded","JSON","parse","atob","e","alert","window","location","href","Provider","value","children","fileName","_jsxFileName","lineNumber","columnNumber","className","_c","mapStateToProps","state","tokenUser","LoginReducer","dataCart","UserReducer","mapDispatchToProps","$RefreshReg$"],"sources":["C:/Thuchanh/Painter/frontend/src/pages/History/index.js"],"sourcesContent":["/* eslint-disable react-hooks/exhaustive-deps */\r\nimport React, { useState, useEffect } from 'react';\r\nimport HeaderHistory from '../../components/Layout/DefautLayout/HeaderHistory';\r\nimport styles from './History.module.scss';\r\nimport classNames from 'classnames/bind';\r\nimport { createContext } from 'react';\r\nimport { useUser } from '../../hook/UserContext';\r\nimport Loader from '~/components/items/Loader';\r\nimport { Link } from 'react-router-dom';\r\nimport useSharedState from '~/hook/useShareState';\r\nimport { connect } from \"react-redux\";\r\nimport { userLogout } from \"../../actionCreators/LoginAction\";\r\n\r\nconst cx = classNames.bind(styles);\r\n\r\nexport const SizeContext = createContext();\r\n\r\nfunction History(props) {\r\n    const [loading, setLoading] = useState(true);\r\n    const [width, setWidth] = useState(1080);\r\n    const [height, setHeight] = useState(540);\r\n    const pathBackEnd = 'http://localhost:8081';\r\n\r\n    const [currentUser, setCurrentUser] = useState(null);\r\n\r\n    const [updateIsEdit] = useSharedState();\r\n\r\n    const setSize = (newWidth, newHeight) => {\r\n        setWidth(newWidth);\r\n        setHeight(newHeight);\r\n    };\r\n\r\n    const [images, setImages] = useState([]);\r\n\r\n    const handleLogout = () => {\r\n        props.userLogout();\r\n    };\r\n\r\n    const email = localStorage.getItem('email')\r\n\r\n\r\n    const fetchImages = async () => {\r\n        try {\r\n            const response = await fetch(`${pathBackEnd}/getAllImages`);\r\n            const responseData = await response.json();\r\n\r\n            console.log('API response:', responseData);\r\n\r\n            const data = Array.isArray(responseData.images) ? responseData.images : [];\r\n\r\n            // const userImages = data.filter((image) => image.user_id === userInfo.user_id);\r\n            setImages(null);\r\n            setLoading(false);\r\n        } catch (error) {\r\n            console.error('Error fetching images:', error);\r\n            setLoading(false);\r\n        }\r\n    };\r\n\r\n    const formatImageDate = (fullDate) => {\r\n        const dateObject = new Date(fullDate);\r\n        const formattedDate = dateObject.toLocaleDateString();\r\n        return formattedDate;\r\n    };\r\n\r\n    const parseJwt = (token) => {\r\n        try {\r\n          const base64Url = token.split(\".\")[1];\r\n          const base64 = base64Url.replace(\"-\", \"+\").replace(\"_\", \"/\");\r\n          const decoded = JSON.parse(atob(base64));\r\n          return decoded;\r\n        } catch (e) {\r\n          console.error(\"Error parsing JWT:\", e);\r\n          return null;\r\n        }\r\n      };\r\n      \r\n      // Usage\r\n      if (localStorage.getItem(\"token-user\")) {\r\n        // setCurrentUser({\r\n        //     email: localStorage.getItem('email'),\r\n        //     token: localStorage.getItem('token-user'),\r\n        // });\r\n      }\r\n    \r\n\r\n    useEffect(() => {\r\n        if (email === null) {\r\n            alert('Directing you back to home');\r\n            window.location.href = '/'; // Redirect to the home page\r\n        } else {\r\n            // Only fetch images if userInfo is not null\r\n            fetchImages();\r\n        }\r\n    }, []);\r\n\r\n\r\n    return (\r\n        <SizeContext.Provider\r\n            value={{\r\n                width,\r\n                height,\r\n                setWidth,\r\n                setHeight,\r\n                setSize,\r\n            }}\r\n        >\r\n            <HeaderHistory handleLogout={handleLogout}/>{' '}\r\n            <div className={cx('wrapper')}>\r\n                <div className={cx('container-history')}>\r\n                    {loading ? (\r\n                        <div className={cx('overlay')}>\r\n                            <Loader />\r\n                        </div>\r\n                    ) : (\r\n                        <>\r\n                            <h3> This is a history details of User: {localStorage.getItem('email')} </h3>{' '}\r\n                            <div className={cx('list-images')}>\r\n                                {/* {images.map((image) => (\r\n                                    <div key={image.imageID} className={cx('image-item')}>\r\n                                        <img src={image.image_data} alt=\"anh\" className={cx('card-image')} />\r\n                                        <p className={cx('image-item-date')}>\r\n                                            Created at: {formatImageDate(image.dateImage)}\r\n                                        </p>\r\n                                        <div className={cx('buttons-action')}>\r\n                                            <Link to={`/edit/${image.imageID}`}>\r\n                                                <button onClick={updateIsEdit}>Edit</button>\r\n                                            </Link>\r\n                                            <button>Delete</button>\r\n                                        </div>\r\n                                    </div>\r\n                                ))} */}\r\n                            </div>\r\n                        </>\r\n                    )}\r\n                </div>\r\n            </div>\r\n        </SizeContext.Provider>\r\n    );\r\n}\r\n\r\nconst mapStateToProps = (state) => {\r\n    return {\r\n      tokenUser: state.LoginReducer.tokenUser,\r\n      dataCart: state.UserReducer.dataCart,\r\n    };\r\n  };\r\n  \r\n  const mapDispatchToProps = {\r\n    userLogout,\r\n  };\r\n  export default connect(mapStateToProps, mapDispatchToProps)(History);"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}